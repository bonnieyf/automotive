<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Link test demo</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600&family=Oswald:wght@200;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./../js.lib/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="./../js.lib/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="./../js.lib/fontawesome/all.css">
    <link rel="stylesheet" href="./../css/dist/web.css" />
    <link rel="stylesheet" href="./assets/web.css" />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-light bg-light gray-shadow-box py-1" data-toggle="sticky-onscroll">
        <div class="container menu">
          <div class="col-lg-6 col-3">
            <a href="../index.html"><img src="./../images/logo-getac.png" alt="" class="img-fluid" style="max-height: 30px;"></a>
          </div>
          <div class="col-lg-6 col-9 text-end">
            <div class="select-lang">
              <span class="select-lang--icon"><i class="fas fa-globe"></i></span>
                <select class="select-lang--select" aria-label="Default select example">
                  <option value="en" selected>English</option>
                  <option value="es">Spanish</option>
                  <option value="jp">Japan</option>
                </select>
            </div>
          </div>	
  
        </div>
      </nav>
    </header>
    <div class="map">
      <a class="room room-1" href="./aftersales_workshop/index.html"
        >Aftersales Workshop</a
      >
      <a class="room room-2" href="./engineering_lab/index.html"
        >Engineering Lab</a
      >
      <a class="room room-3" href="./manufacturing_factory/index.html"
        >Manufacturing Factory</a
      >
      <a class="room room-4" href="./warehouse/index.html">Warehouse</a>
      <img src="./assets/map.webp" alt="" />
    </div>

    <!-- LazyLoad Iframe -->
    <iframe data-src="aftersales_workshop/index.html" loading="lazy" class="unity-iframe"></iframe>
    <iframe data-src="engineering_lab/index.html" loading="lazy" class="unity-iframe"></iframe>
    <iframe data-src="manufacturing_factory/index.html" loading="lazy" class="unity-iframe"></iframe>
    <iframe data-src="warehouse/index.html" loading="lazy" class="unity-iframe"></iframe>
    <script>
    
    window.onload = function(){
      let langSelect = document.querySelector(".select-lang--select");
      let langOptions = langSelect.options;
      let initLang = localStorage.getItem("lang") ? localStorage.getItem("lang") : localStorage.setItem("lang",'en');
      
      for(i = 0; i < langOptions.length; i++){
        langOptions[i].selected = false;
      }
      langOptions[findLangIndex(initLang)].selected = true;
      
     
      langSelect.addEventListener("change", function () {
        let cur = this.value;
        // unityInstance.SendMessage("Canvas", "SendToUnity", "es");
        localStorage.setItem("lang", cur);
        console.log("updated!!");
      });
    }

      if ('loading' in HTMLIFrameElement.prototype) {
      const iframes = document.querySelectorAll('iframe[loading="lazy"]');

      iframes.forEach(iframe => {
        iframe.src = iframe.dataset.src;
      });

    } else {
      const script = document.createElement('script');
      script.src =
        'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js';
      document.body.appendChild(script);
    }

    window.addEventListener('message',function(e){
      const data = e.data;
      console.log('[ '+data+' ]page loaded!!!')
    })

    

    function findLangIndex(str){
      switch(str){
        case 'en':
          str = 0;
          break;
        case 'es':
          str = 1;
          break;
        case 'jp':
          str = 2;
          break;
      }
      return str;
    }

    
    
    </script>
  </body>
</html>
